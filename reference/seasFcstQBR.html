<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Seasonal Forecast of Wet Season Calendar (WSC) from Tercile Rainfall Probabilities using Quantile Bin Resampling (QBR) — seasFcstQBR • AquaBEHER</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Seasonal Forecast of Wet Season Calendar (WSC) from Tercile Rainfall Probabilities using Quantile Bin Resampling (QBR) — seasFcstQBR"><meta name="description" content="This function generates seasonal forecasts for Wet Season Calendar (WSC)
variables (onset or cessation) using tercile seasonal rainfall probabilities"><meta property="og:description" content="This function generates seasonal forecasts for Wet Season Calendar (WSC)
variables (onset or cessation) using tercile seasonal rainfall probabilities"><meta property="og:image" content="https://robeltakele.github.io/AquaBEHER/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AquaBEHER</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/AquaBEHER.html">Tutorial</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">User Guide</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobelTakele/AquaBEHER" aria-label="GitHub Repo"><span class="fa fab fa-github fa-lg"></span> GitHub</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobelTakele/AquaBEHER/issues" aria-label="Report Issues"><span class="fa fas fa-exclamation-circle fa-lg"></span> Issues</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Seasonal Forecast of Wet Season Calendar (WSC) from Tercile Rainfall Probabilities using Quantile Bin Resampling (QBR)</h1>
      <small class="dont-index">Source: <a href="https://github.com/RobelTakele/AquaBEHER/blob/master/R/seasFcstQBR.R" class="external-link"><code>R/seasFcstQBR.R</code></a></small>
      <div class="d-none name"><code>seasFcstQBR.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function generates seasonal forecasts for Wet Season Calendar (WSC)
variables (onset or cessation) using tercile seasonal rainfall probabilities</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">seasFcstQBR</span><span class="op">(</span></span>
<span>  <span class="va">hisYearStart</span>,</span>
<span>  <span class="va">hisYearEnd</span>,</span>
<span>  <span class="va">rainTerc</span>,</span>
<span>  <span class="va">seasRain</span>,</span>
<span>  <span class="va">hisWSCvar</span>,</span>
<span>  <span class="va">fcstVarName</span>,</span>
<span>  <span class="va">tercileMethod</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-hisyearstart">hisYearStart<a class="anchor" aria-label="anchor" href="#arg-hisyearstart"></a></dt>
<dd><p>Starting year (YYYY) for historical resampling.</p></dd>


<dt id="arg-hisyearend">hisYearEnd<a class="anchor" aria-label="anchor" href="#arg-hisyearend"></a></dt>
<dd><p>Ending year (YYYY) for historical resampling.</p></dd>


<dt id="arg-rainterc">rainTerc<a class="anchor" aria-label="anchor" href="#arg-rainterc"></a></dt>
<dd><p>A data frame with tercile probabilities for rainfall.
Columns should be named "T1" (below normal), "T2" (normal), and "T3"
(above normal).</p></dd>


<dt id="arg-seasrain">seasRain<a class="anchor" aria-label="anchor" href="#arg-seasrain"></a></dt>
<dd><p>A data frame containing seasonal rainfall data with columns</p></dd>


<dt id="arg-hiswscvar">hisWSCvar<a class="anchor" aria-label="anchor" href="#arg-hiswscvar"></a></dt>
<dd><p>A data frame containing historical WSC simulations. This can
be the output from the <code>calcSeasCal</code> function or a similar data frame with
required columns.</p></dd>


<dt id="arg-fcstvarname">fcstVarName<a class="anchor" aria-label="anchor" href="#arg-fcstvarname"></a></dt>
<dd><p>A character string indicating the WSC variable to forecast
("Onset" or "Cessation").</p></dd>


<dt id="arg-tercilemethod">tercileMethod<a class="anchor" aria-label="anchor" href="#arg-tercilemethod"></a></dt>
<dd><p>options are "quantiles" or "fixedValues"</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing the tercile probabilities for the WSC
variable ("BelowNormal", "Normal", and "AboveNormal").</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function uses QBR (Quantile Bin Resampling) to produce forecasts for
onset or cessation of the rainy season. It first categorizes historical WSC
simulations based on seasonal rainfall terciles and then resamples based on
given rainfall probabilities to generate ensemble forecasts.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>MacLeod D, Quichimbo EA, Michaelides K, Asfaw DT, Rosolem R, Cuthbert MO,
et al. (2023) Translating seasonal climate forecasts into water balance
forecasts for decision making. PLOS Clim 2(3): e0000138.
https://doi.org/10.1371/journal.pclm.0000138</p></li>
<li><p>van den Dool HM. A New Look at Weather Forecasting through Analogues.
Monthly Weather Review. 1989; 117(10):2230–2247.
https://doi.org/10.1175/1520-0493(1989)117%3C2230:ANLAWF%3E2.0.CO;2</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="calcSeasCal.html">calcSeasCal</a>, <a href="calcWatBal.html">calcWatBal</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘dplyr’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     filter, lag</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     intersect, setdiff, setequal, union</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Load example data:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">AgroClimateData</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimate daily PET:</span></span></span>
<span class="r-in"><span><span class="va">PET</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcEto.html">calcEto</a></span><span class="op">(</span><span class="va">AgroClimateData</span>, method <span class="op">=</span> <span class="st">"PM"</span>, Zh <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Adjusted 0 instances where Tmin was equal to or greater than Tmax.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Penman-Monteith FAO56 Reference Crop ET</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Evaporative surface: FAO-56 hypothetical short grass, albedo = 0.23 ; surface resistance = 70 sm^-1; crop height = 0.12 m; roughness height = 0.02 m</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Timestep: daily</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Units: mm</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Time duration: 1982-01-01 to 2022-12-31</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add the estimated PET 'ET.Daily' to a new column in AgroClimateData:</span></span></span>
<span class="r-in"><span><span class="va">AgroClimateData</span><span class="op">$</span><span class="va">Eto</span> <span class="op">&lt;-</span> <span class="va">PET</span><span class="op">$</span><span class="va">ET.Daily</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimate daily water balance for the soil having 100mm of WHC:</span></span></span>
<span class="r-in"><span><span class="va">watBal.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcWatBal.html">calcWatBal</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">AgroClimateData</span>, soilWHC <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">watBal</span> <span class="op">&lt;-</span> <span class="va">watBal.list</span><span class="op">$</span><span class="va">data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## seasonal calendar is estimated for the onset window ranges from</span></span></span>
<span class="r-in"><span><span class="co">## 01 September to 31 January having a soil with 100mm of WHC:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">soilWHC</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">onsetWind.start</span> <span class="op">&lt;-</span> <span class="st">"09-01"</span></span></span>
<span class="r-in"><span><span class="va">onsetWind.end</span> <span class="op">&lt;-</span> <span class="st">"01-31"</span></span></span>
<span class="r-in"><span><span class="va">cessaWind.end</span> <span class="op">&lt;-</span> <span class="st">"06-30"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">seasCal.dF</span> <span class="op">&lt;-</span> <span class="fu"><a href="calcSeasCal.html">calcSeasCal</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">watBal</span>, <span class="va">onsetWind.start</span>, <span class="va">onsetWind.end</span>,</span></span>
<span class="r-in"><span>  <span class="va">cessaWind.end</span>, <span class="va">soilWHC</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Tercile Rainfall Probabilities of seasonal Forecast for OND, 2023:</span></span></span>
<span class="r-in"><span><span class="va">rainTerc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>T1 <span class="op">=</span> <span class="fl">0.15</span>, T2 <span class="op">=</span> <span class="fl">0.10</span>, T3 <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Summarize rainfall data for October to December:</span></span></span>
<span class="r-in"><span><span class="va">seasRain</span> <span class="op">&lt;-</span> <span class="va">AgroClimateData</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>sRain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Rain</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Start of the historical resampling year</span></span></span>
<span class="r-in"><span><span class="va">hisYearStart</span> <span class="op">&lt;-</span> <span class="fl">1991</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## End of the historical resampling year</span></span></span>
<span class="r-in"><span><span class="va">hisYearEnd</span> <span class="op">&lt;-</span> <span class="fl">2022</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Historical WSC Simulations:</span></span></span>
<span class="r-in"><span><span class="va">hisWSCvar</span> <span class="op">&lt;-</span> <span class="va">seasCal.dF</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## WSC variable to forecast:</span></span></span>
<span class="r-in"><span><span class="va">fcstVarName</span> <span class="op">&lt;-</span> <span class="st">"Onset"</span></span></span>
<span class="r-in"><span><span class="va">tercileMethod</span> <span class="op">&lt;-</span> <span class="st">"quantiles"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">SeasFcst.dF</span> <span class="op">&lt;-</span> <span class="fu">seasFcstQBR</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">hisYearStart</span>, <span class="va">hisYearEnd</span>, <span class="va">rainTerc</span>,</span></span>
<span class="r-in"><span>  <span class="va">seasRain</span>, <span class="va">hisWSCvar</span>, <span class="va">fcstVarName</span>,</span></span>
<span class="r-in"><span>  <span class="va">tercileMethod</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robel Takele, Matteo Dell’Acqua.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

